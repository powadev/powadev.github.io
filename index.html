<!DOCTYPE html>
<meta charset="UTF-8">
<html>

	<head>
		<script type="text/javascript">
		var wsnet = null;
	</script>
		<script type="text/javascript" src="/js/browserfs.min.js"></script>
		<script src="/js/pyodide/pyodide.js"></script>
		<script src="consolescript.js"></script>


	</head>

	<body>
		<br>
		Set up WSNET proxy on your localhost, then hit the START button, <br>
		your browser will connect to the proxy and load the Python interpreter.<br>
		Sample implementation of the WSNET proxy can be found <a href="https://github.com/skelsec/wsnet/">here</a>
		<br>
		<br>
		WS->TCP Proxy url <input type="text" id="proxyurl"
			value="ws://127.0.0.1:8700">
		<input id="startButton" type="button" value="START"
			style="background-color:grey" size="50" onclick="start();" />
		STATUS: <input id="statusButton" type="button" value="DISCONNECTED"
			style="background-color:grey" size="50" />
		<br>
		<br>
		Console <input id="historydownloadbutton" type="button" value="DOWNLOAD HISTORY"
				style="background-color:grey" size="50" onclick="saveHistory();" /><br>
		<textarea id="consoleoutput" name="consoleoutput" rows="30" cols="100"></textarea><br>
		<textarea id="consoleinput" name="consoleinput" rows="1" cols="95"></textarea>
		<input id="commandButton" type="button" value="RUN" style="background-color:grey" size="50" disabled onclick="runCmd();" />
		<br>
		<input id="refreshFilesButton" type="button" value="REFRESHFILES"
			style="background-color:grey" size="50" onclick="refreshfiles();" />
		
		<br>
		<br>
		<input id="addSMBConsoleButton" type="button" value="SMBCONSOLE"
			style="background-color:grey" size="50" onclick="addConsole('smb');" />
		<br>

		<label for="ntds">NTDS file</label>
		<input type="file" id="ntdsfile" name="ntdsfile">
		<br>
		<label for="sysreg">SYSTEM hive:</label>
		<input type="file" id="sysregfile" name="sysregfile">
		<input id="parseButton" type="button" value="PARSE" style="background-color:grey" size="50" onclick="parseNTDS();" />
		<br>
		<br>
		

		Type "help" for list of available commands<br>
		First command should be "login url". DO NOT FORGET TO add "proxytype=wsnet" in the url params for both LDAP and SMB!! <br>
		SMB example login command: <br>
		login "smb2+ntlm-password://TEST\victim:Passw0rd!1@10.10.10.2/?proxytype=wsnet" <br>
		<br>
		Switch bethween SMB and LDAP client using the achor in the URL (#smb or #ldap appended to the url)<br>
	</body>
</html>